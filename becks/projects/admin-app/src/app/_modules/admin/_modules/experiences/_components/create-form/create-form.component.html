<section id="formSection" class="fullSection content-flex-all-center">
  <div class="full-height padding-form">
    <form [formGroup]="userEditForm" autocomplete="off" class="general-row">
        <div class="form-section section1">
         <!-- name exp -->
          <ion-row >
            <span class="people-icon" style="margin-right: 30px;"> </span>

            <mat-form-field
            appearance="fill"
            floatLabel="auto"
            class="middleInput"
            [ngClass]="getClassInput(userEditForm.controls.name)"
          >
            <mat-label>Nombre de la experiencia</mat-label>
            
            <input
              matInput
              (input)="inputValidatorAlphabetical($event)"
              formControlName="name"
              maxlength="100"
           
              data-qadp="name"
              required
            />
            <mat-error *ngIf="userEditForm.controls.name.touched &&  userEditForm.controls.name.errors">
              *Has ingresado un dato inválido
            </mat-error>
          </mat-form-field>
  
          </ion-row>
          <!-- start and finish dates  -->
          <ion-row>
            <span class="schedule-icon"> </span>
            <mat-form-field
            appearance="fill"
            floatLabel="auto"
            class="smallInput"
            [ngClass]="getClassInput(userEditForm.controls.dateStart)"
            >
            <mat-label>Fecha y hora inicial de la publicación</mat-label>
            <input 
            matInput 
            [ngxMatDatetimePicker]="picker1"
            formControlName="dateStart"
            required
            >
          <mat-datepicker-toggle matSuffix [for]="picker1">
          <mat-icon matDatepickerToggleIcon>keyboard_arrow_down</mat-icon>
          </mat-datepicker-toggle>
          <ngx-mat-datetime-picker #picker1 [showSpinners]="true" [showSeconds]="true"
             [touchUi]="false" [enableMeridian]="false" [disableMinute]="false">
          </ngx-mat-datetime-picker>
          <mat-error *ngIf="userEditForm.controls.dateStart.touched &&  userEditForm.controls.dateStart.errors">
            *Has ingresado un dato inválido
          </mat-error>
           </mat-form-field>

           <mat-form-field
           appearance="fill"
           floatLabel="auto"
           class="smallInput"
           [ngClass]="getClassInput(userEditForm.controls.dateEnd)"
           >
           <mat-label>Fecha y hora final de la publicación</mat-label>
           <input 
           matInput 
           [ngxMatDatetimePicker]="picker2"
           formControlName="dateEnd"
           required
           >
         <mat-datepicker-toggle matSuffix [for]="picker2">
          <mat-icon matDatepickerToggleIcon>keyboard_arrow_down</mat-icon>
         </mat-datepicker-toggle>
         <ngx-mat-datetime-picker #picker2 [showSpinners]="true" [showSeconds]="true" 
           [touchUi]="false" [enableMeridian]="false" [disableMinute]="false">
         </ngx-mat-datetime-picker>
         <mat-error *ngIf="userEditForm.controls.dateEnd.touched &&  userEditForm.controls.dateEnd.errors">
          *Has ingresado un dato inválido
        </mat-error>
          </mat-form-field>
           
          </ion-row>
          <!-- location  -->
          <ion-row>
            <span class="location-icon"> </span>
            <mat-form-field
            appearance="fill"
            floatLabel="auto"
            class="fullInput"
            [ngClass]="getClassInput(userEditForm.controls.location)"
          >
            <mat-label>Ubicación</mat-label>
            
            <input
              matInput
              (input)="inputValidatorAlphabetical($event)"
              formControlName="location"
              maxlength="100"
              data-qadp="location"
              required
            />
            <mat-error *ngIf="userEditForm.controls.location.touched &&  userEditForm.controls.location.errors">
              *Has ingresado un dato inválido
            </mat-error>
          </mat-form-field>
          </ion-row>
          <!-- description  -->
          <ion-row>
            <span class="text-icon"> </span>
            <mat-form-field
            appearance="fill"
            floatLabel="auto"
            class="fullInput"
            [ngClass]="getClassInput(userEditForm.controls.descrip)"
          >
            <mat-label>Agregar descripción de la experiencia</mat-label>
            <textarea 
            matInput
            (input)="inputValidatorAlphabetical($event)"
              formControlName="descrip"
              maxlength="500"
              data-qadp="descrip"
              required
              ></textarea>
            <mat-error *ngIf="userEditForm.controls.descrip.touched &&  userEditForm.controls.descrip.errors">
              *Has ingresado un dato inválido
            </mat-error>
          </mat-form-field>
          </ion-row>
          <!-- stock  -->
          <ion-row>
            <span class="stock-icon"> </span>
            <div>
              <ion-row class="space-between">
                <p>
                  ¿La  experiencia requiere stock  o inventario?
                </p>
                <mat-slide-toggle  [checked]="!this.hideStk" name="stk" (change)="hideField($event.source.name,$event.source._checked)"></mat-slide-toggle>
              </ion-row>
              <ion-row 
              *ngIf="!this.hideStk"
              >
              <mat-form-field
              appearance="fill"
              floatLabel="auto"
              class="smallInput"
              [ngClass]="getClassInputNotReq(userEditForm.controls.stock)"
              hideRequiredMarker
            >
              <mat-label>Cupos</mat-label>
              
              <input
                matInput
                (input)="inputValidatorNumeric($event)"
                formControlName="stock"
                maxlength="60"
                data-qadp="stock"
                required
              />
              <mat-error *ngIf="userEditForm.controls.stock.touched &&  userEditForm.controls.stock.errors">
                *Has ingresado un dato inválido
            </mat-error>
            </mat-form-field>
              </ion-row>
            </div>
           
          </ion-row>
          <!-- periodicity -->
          <ion-row>
            <span class="time-icon"> </span>
            <div formArrayName="itemRows">
              <ion-row class="space-between">
                <p>
                  ¿La experiencia requiere periodicidad?
                </p>
                <mat-slide-toggle  [checked]="!this.hidePed" name="ped" (change)="hideField($event.source.name,$event.source._checked)"></mat-slide-toggle>
              </ion-row>
              <ion-row 
              *ngFor="let itemrow of userEditForm.get('itemRows')['controls']; let i=index"
              [formGroupName] = "i">
                <mat-form-field
                *ngIf="!this.hidePed"
                appearance="fill"
                floatLabel="auto"
                class="smallInput"
                [ngClass]="getClassInputNotReq( this.userEditForm.controls.itemRows['controls'][i].controls.period)"
                hideRequiredMarker
                >
                <mat-label>Cupos</mat-label>
                
                <input
                  id="period{{i}}"
                  matInput
                  (input)="inputValidatorNumeric($event)"
                  formControlName="period"
                  maxlength="60"
                  minlength="1"
                  data-qadp="period"
                  required
                />
                <mat-error *ngIf="userEditForm.controls.itemRows['controls'][i].controls.period.touched &&  userEditForm.controls.itemRows['controls'][i].controls.period.errors">
                  *Has ingresado un dato inválido
                </mat-error>
              </mat-form-field>
      
               <mat-form-field
               *ngIf="!this.hidePed"
               appearance="fill"
               floatLabel="auto"
               class="smallInput"
               [ngClass]=" getClassInputNotReq( this.userEditForm.controls.itemRows['controls'][i].controls.dateRelease)"
               hideRequiredMarker
               >
               <mat-label>Fecha de liberación</mat-label>
               <input 
               id="dateRelease{{i}}"
               matInput 
               formControlName="dateRelease"
               [ngxMatDatetimePicker]="picker3"
               required
               >
             <mat-datepicker-toggle matSuffix [for]="picker3">
              <mat-icon matDatepickerToggleIcon>keyboard_arrow_down</mat-icon>
             </mat-datepicker-toggle>
             <ngx-mat-datetime-picker #picker3 [showSpinners]="true" [showSeconds]="true" 
               [touchUi]="false" [enableMeridian]="false" [disableMinute]="false">
             </ngx-mat-datetime-picker>
            <mat-error *ngIf="userEditForm.controls.itemRows['controls'][i].controls.dateRelease.touched &&  userEditForm.controls.itemRows['controls'][i].controls.dateRelease.errors">
              *Has ingresado un dato inválido
            </mat-error>
              </mat-form-field>
               <button
               *ngIf="!this.hidePed && userEditForm.controls.itemRows['controls'].length > 1"
               class="btn-delete"
                (click)="deleteField(i)"
               >
                 <span class="trash-icon"> </span>
               </button>
              </ion-row>
              <ion-row>
                <button 
                *ngIf="!this.hidePed"
                (click)="addField()"
                class="btn-add"
                >
                  <span class="plus-icon"></span>
                  <span class="text-add">Añadir</span>
                </button>
              </ion-row>
            </div>
          </ion-row>
          <!-- path -->
          <ion-row>
            <span class="path-icon"> </span>
              <div>
                <ion-row class="space-between">
                  <p>
                    ¿La  experiencia requiere un enlace?
                  </p>
                  <mat-slide-toggle name="path" [checked]="!this.hidepath" (change)="hideField($event.source.name,$event.source._checked)"></mat-slide-toggle>
                </ion-row>

          <mat-form-field
          *ngIf="!this.hidepath"
          appearance="fill"
          floatLabel="auto"
          class="fullInput"
          [ngClass]="getClassInput(userEditForm.controls.path)"
          hideRequiredMarker
        >
          <mat-label>URL</mat-label>
          
          <input
            matInput
            (input)="inputValidatorAlphaNumeric($event)"
            formControlName="path"
            maxlength="100"
            data-qadp="path"
            required
          />
          <mat-error *ngIf="userEditForm.controls.path.touched &&  userEditForm.controls.path.errors">
            *Has ingresado un dato inválido
          </mat-error> 
        </mat-form-field>


            <!-- <ion-row class="space-around"    *ngIf="!this.hidepath">
              <mat-checkbox 
              id="mat-checkbox-inside"
              [checked]="!this.checked" 
              (change)="unCheck($event)"

              >
            </mat-checkbox>
              
             <p>Contenido embebido dentro de la APP</p>
              <mat-checkbox 
              id="mat-checkbox-outside"
              [checked]="this.checked" 
              (change)="unCheck($event)"
              
              >
            </mat-checkbox> 
            <p>Enlace o link externo (dirige a otra página)</p>
   
            </ion-row>    -->
          </div>
          </ion-row>
          <!-- loaded img -->
          <ion-row>
            <span class="img-icon"> </span>
            <p>
              Cargar imagen de la experiencia
            </p>
            <ion-row class="margin-left">
              <div>
              <input
              id="selectedFile"
              style="display: none"
              type="file"
              (change)="loadImage($event,'des')"
              id="file-input"
              accept="image/png, image/jpeg"
              value="expEditable.imagesExp" 
              #hiddenfileinput1
            />
              <p>Subir imagen desktop*</p>
              <button class="btn-upload" (click)="hiddenfileinput1.click()">
                <span class="upload-icon" *ngIf="!(this.loadedFileDes.length > 0) && !typeError"> </span>
                <span class="upload-icon-error" *ngIf="typeError && !this.loadedFileDes"> </span>
                <ion-row *ngIf="this.loadedFileDes.length > 0">
                  <span class="btn-text">
                    <span>{{ this.loadedFileDes}}</span>
                  </span>
                  <button (click)="clear('D')" class="btn-x">
                    <span class="x-icon"> </span>
                  </button>
                </ion-row>
              </button>
             </div>
            <div style="margin-left: 30px;">
              <input
              id="selectedFile"
              style="display: none"
              type="file"
              (change)="loadImage($event,'mob')"
              id="file-input"
              accept="image/png, image/jpeg"
              value="expEditable.imagesExpMob" 
              #hiddenfileinput2
            />
              <p>Subir imagen mobile*</p>
              <button class="btn-upload" (click)="hiddenfileinput2.click()">
                <span class="upload-icon" *ngIf="!(this.loadedFileMob.length > 0) && !typeError"> </span>
                <span class="upload-icon-error" *ngIf="typeError && !this.loadedFileMob"> </span>
                <ion-row *ngIf=" this.loadedFileMob.length > 0">
                  <span class="btn-text">
                    <span>{{ this.loadedFileMob}}</span>
                  </span>
                  <button (click)="clear('M')" class="btn-x">
                    <span class="x-icon"> </span>
                  </button>
                </ion-row>
              </button>
            </div>
            </ion-row>
          </ion-row>
          <mat-error style="margin-left: 50px;"  *ngIf=" showError && loadedFileMob.length == 0 || showError && loadedFileDes.length == 0">
            *Debes subir una imágen válida
          </mat-error>
          <mat-error style="margin-left: 50px;"  *ngIf=" typeError">
            *El archivo no es válido
          </mat-error>
        </div>

    </form>

    <br /><mat-error *ngIf="httpError" class="error-http">{{ httpError }}</mat-error>
    <ion-row class="margin-left ">
      <button
      block="block"
      color="becks"
      (click)="saveExp()"
      class="becks-btn-primary button-width"
      [ngClass]="{
        'button-disabled': userEditForm.controls.name.invalid ||
        userEditForm.controls.dateStart.invalid || 
        userEditForm.controls.dateEnd.invalid ||
        userEditForm.controls.location.invalid ||
        userEditForm.controls.descrip.invalid ||
        this.loadedFileDes.length == 0  || 
        this.loadedFileMob.length == 0
      }"
      data-qadp="send-button-form"
    >
      <span>CREAR EXPERIENCIA</span>
    </button>
    <button class="btn-cancel"
      (click) = "openModal()"
    >
      <span>CANCELAR</span>
    </button>
    </ion-row>
  </div>
</section>
